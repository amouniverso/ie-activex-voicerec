<!DOCTYPE html>
<html>
<head>
<title>IE-ACTIVEX-VOICEREC</title>
<script src="FileSaver.min.js"></script>
</head>
<body>

<h1>IE-ACTIVEX-VOICEREC demo</h1>
<button onClick="startRecording()" id="startButton" >Start Recording</button>
<button onClick="stopRecording()" id="stopButton" >Stop Recording</button>
<OBJECT width=0 height=0 CLASSID="clsid:75943fab-f874-4a9d-a482-654034ae1928" id="voicerec"></OBJECT>
<SCRIPT>
	obj = document.getElementById('voicerec');
	document.getElementById('stopButton').disabled = true;
	function startRecording() {
		var result = obj.startRecording()
		console.log("Recording started. Speak now!");
		document.getElementById('startButton').disabled = true;
		document.getElementById('stopButton').disabled = false;
	}
	function stopRecording() {
		var base64string = obj.stopRecording();
		blob = new Blob([base64string], {type: 'text/plain;charset=utf-8'});
		saveAs(blob, "voicerec_8000_16pcm.txt");
		document.getElementById('stopButton').disabled = true;
		document.getElementById('startButton').disabled = false;
	}
</SCRIPT>
</body>
</html>